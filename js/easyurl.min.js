window.easyurl||(window.easyurl={},window.easyurl.scriptsLoaded=!1),window.easyurl.scriptsLoaded||(window.easyurl.init=function(){window.easyurl.load_list_script()},window.easyurl.load_list_script=function(){if(!window.easyurl.scriptsLoaded){let e=void 0,o=void 0;for(e in window.easyurl)for(o in window.easyurl[e].init&&window.easyurl[e].init(),window.easyurl[e])window.easyurl[e]&&window.easyurl[e][o]&&window.easyurl[e][o].init&&window.easyurl[e][o].init();window.easyurl.scriptsLoaded=!0}},window.easyurl.refresh=function(){let e=void 0,o=void 0;for(e in window.easyurl)for(o in window.easyurl[e].refresh&&window.easyurl[e].refresh(),window.easyurl[e])window.easyurl[e]&&window.easyurl[e][o]&&window.easyurl[e][o].refresh&&window.easyurl[e][o].refresh()},$(document).ready(window.easyurl.init)),window.easyurl.exportshortener={},window.easyurl.exportshortener.init=function(){window.easyurl.exportshortener.event()},window.easyurl.exportshortener.event=function(){},window.easyurl.exportshortener.generateExport=function(e){var o=window.saturne.toolbox.getToken(),n=window.saturne.toolbox.getQuerySeparator(document.URL);$.ajax({method:"POST",url:document.URL+n+"action=generate_export&nb_url="+e+"&token="+o,processData:!1,contentType:!1,success:function(e){window.saturne.notice.showNotice("notice-infos","Success","ExportSuccess","success"),window.saturne.loader.remove($("#generate-url-from .button-save")),$("#shortener-export-table").replaceWith($(e).find("#shortener-export-table"))}})},window.easyurl.shortener={},window.easyurl.shortener.init=function(){window.easyurl.shortener.event()},window.easyurl.shortener.event=function(){$(document).on("click",".toggleObjectInfo",window.easyurl.shortener.toggleObjectInfo),$(document).on("click",".show-qrcode",window.easyurl.shortener.showQRCode),$(document).on("change","#fromid",window.easyurl.shortener.reloadAssignShortenerView),$(document).on("click",".button-save.assign-button",window.easyurl.shortener.assignShortener),$(document).on("submit","#generate-url-from",window.easyurl.shortener.buttonSave)},window.easyurl.shortener.toggleObjectInfo=function(){$(this).hasClass("fa-minus-square")?($(this).removeClass("fa-minus-square").addClass("fa-caret-square-down"),$(this).closest(".fiche").find(".ObjectInfo tbody").hide()):($(this).removeClass("fa-caret-square-down").addClass("fa-minus-square"),$(this).closest(".fiche").find(".ObjectInfo tbody").show())},window.easyurl.shortener.showQRCode=function(){var e=window.saturne.toolbox.getQuerySeparator(document.URL),o=window.saturne.toolbox.getToken();let n;n=$(this).hasClass("fa-toggle-off")?1:0,window.saturne.loader.display($(this)),$.ajax({url:document.URL+e+"action=show_qrcode&token="+o,type:"POST",processData:!1,data:JSON.stringify({showQRCode:n}),contentType:!1,success:function(e){window.location.reload()},error:function(){}})},window.easyurl.shortener.reloadAssignShortenerView=function(){var e=$(this).val(),o=window.saturne.toolbox.getToken(),n=window.saturne.toolbox.getQuerySeparator(document.URL);window.saturne.loader.display($(".assign-form")),$.ajax({url:document.URL+n+"fromid="+e+"&token="+o,type:"POST",processData:!1,contentType:!1,success:function(e){$(".assign-form").replaceWith($(e).find(".assign-form"))},error:function(){}})},window.easyurl.shortener.assignShortener=function(){var e=window.saturne.toolbox.getToken(),o=window.saturne.toolbox.getQuerySeparator(document.URL);$.ajax({url:document.URL+o+"view&token="+e,type:"POST",processData:!1,contentType:!1,success:function(){window.parent.jQuery("#idfordialogassignShortener").dialog("close")},error:function(){}})},window.easyurl.shortener.buttonSave=function(e){e.preventDefault();var e=new FormData($("#generate-url-from")[0]),o=parseInt(e.get("nb_url"));window.saturne.loader.display($("#generate-url-from .button-save")),window.easyurl.shortener.createShortener(e,1,o)},window.easyurl.shortener.createShortener=function(o,n,r){var e=window.saturne.toolbox.getToken(),t=window.saturne.toolbox.getQuerySeparator(document.URL);$.ajax({method:"POST",url:document.URL+t+"action=generate_url&nb_url="+n+"&token="+e,data:JSON.stringify(Object.fromEntries(o)),processData:!1,contentType:!1,success:function(e){"true"==$(e).find('input[name="success"]').val()?n<r?(window.saturne.notice.showNotice("notice-infos","Success","ExportGenerating "+n+" URLs !","success"),window.easyurl.shortener.createShortener(o,++n,r)):window.easyurl.exportshortener.generateExport(r):window.saturne.notice.showNotice("notice-infos","Error","ExportError "+n,"error")}})};